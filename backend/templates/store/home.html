{% extends "base/base.html" %}

{% block content %}
<div x-data="{ filtersOpen: true }" class="space-y-6">
  <!-- Header + Filters toggle -->
  <div class="flex items-center justify-between">
    <h2 class="text-2xl font-semibold text-gray-900">Our Products</h2>
    <button @click="filtersOpen = !filtersOpen"
            class="inline-flex items-center gap-2 px-3 py-2 rounded border text-sm bg-white hover:bg-gray-50">
      <svg class="h-4 w-4 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
           stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3 4.5h18M6 9.75h12M10 15h4m-7 4.5h10" />
      </svg>
      <span x-text="filtersOpen ? 'Hide filters' : 'Show filters'"></span>
    </button>
  </div>

  <!-- Filters -->
  <form
    x-show="filtersOpen"
    class="p-4 bg-white rounded-lg shadow space-y-4"
    hx-get="/search-products/"
    hx-target="#results"
    hx-swap="innerHTML"
    hx-trigger="input changed delay:300ms, change"
  >
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <div class="md:col-span-2">
        <label class="block text-sm text-gray-600 mb-1">Search</label>
        <input type="text" name="q" placeholder="Search products..."
               class="w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-200" />
      </div>

      <div>
        <label class="block text-sm text-gray-600 mb-1">Min price</label>
        <input type="number" name="min_price" step="0.01" min="0" placeholder="0.00"
               class="w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-200" />
      </div>

      <div>
        <label class="block text-sm text-gray-600 mb-1">Max price</label>
        <input type="number" name="max_price" step="0.01" min="0" placeholder="9999.99"
               class="w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-200" />
      </div>
    </div>

    <div class="flex items-center gap-3">
      <label class="text-sm text-gray-600">Sort</label>
      <select name="sort" class="border rounded px-3 py-2 text-sm focus:outline-none focus:ring focus:ring-blue-200">
        <option value="newest" selected>Newest</option>
        <option value="price_asc">Price: Low to High</option>
        <option value="price_desc">Price: High to Low</option>
        <option value="name_asc">Name: A → Z</option>
        <option value="name_desc">Name: Z → A</option>
      </select>

      <button type="reset" class="ml-auto text-sm px-3 py-2 rounded border bg-white hover:bg-gray-50">
        Reset
      </button>
    </div>
  </form>

  <!-- Results -->
  <div id="results">
    {% include "store/partials/product_grid.html" with products=products %}
  </div>
</div>
{% endblock %}